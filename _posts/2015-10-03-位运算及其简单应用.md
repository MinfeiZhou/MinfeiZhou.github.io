---
layout: post
title: 位运算及其简单应用
description: "位运算及其简单应用"
tags: [位运算, 编程基础]
modified: 2015-10-03
---

> 前些天看了《编程之法》中一道字符串包含的问题，作者使用位运算方法模拟散列表，从而巧妙的解答了这个问题，大大降低了时间复杂度，小弟我再次被自己的渣渣智商打击到了。虽然笔者也在两数交换中用到过位运算，然而仅仅是用过，并没有对位运算做过更多的了解，直到……哎，痛定思痛，闲话不多说了，开始献丑，各位看官将就着看。

## 0 基本概念

| 运算符 | 含义 |
|:------:|:-------:|
| &      |  按位与  |
| I      |  按位或  |
| ^      |按位异或  |
| ~      |  取反    |
| <<     |  左移    |
| >>     | 右移     |
{: rules="groups"}


## 1 按位与运算符 &

### 1.1 运算规则
位与运算的实质是：参与运算的两个数按其对应的二进制进行逐位 与 运算，如果两个数在对应二进位的值都为1，则该位的 & 运算结果为 1 ，否则为 0 ，即:

    0 & 0 = 0
    0 & 1 = 0
    1 & 0 = 0
    1 & 1 = 1

例如：3 & 8 的运算过程

    3 = 00000011
    5 = 00000101 &
        00000001 结果

因此 3 & 5 = 1， 如果参与 & 运算的是负数，如： -3 & -5 ，则以补码形式表示为对应的二进制数，然后按位进行运算。

### 1.2 简单应用

#### 1.2.1 清零
如果想将一个单元清零，即使其全部二进位为 0，只要找一个二进制数，其中各个位符合以下条件：原来数中为 1 的位，新数中相应位为 0。然后使二者进行 & 运算，即可以达到清零目的。

#### 1.2.2 取一个数中某些指定位-（摘自其他博文，笔者暂不直销实际中如何应用）
如有一个整数 a （2个字节，8位）想要其中的低4位，只需将 a 与 0x0F 进行按位与运算即可。

#### 1.2.3 保留指定二进制位-（摘自其他博文，笔者暂不直销实际中如何应用）
如二进制数 01010100 ，想保留其左起第3，4，5，7，8位，可以这样运算：

    01010100
    00111011 &
    00010000 结果

## 2 按位或运算符 |

### 2.1 运算规则
两数相对应的二进制位上只要有一个为 1，则该位 | 运算的结果为 1。

    0 | 0 = 0
    0 | 1 = 1
    1 | 0 = 1
    1 | 1 = 1

### 2.2 简单应用
按位或运算常用来将一个数的某些位定值为1，如一个整数 a（16位），表达式 a & 0x0077 ，则低 a 的低8位在运算后其值被全部置为 1 ，高 8 位保留原样。

## 3 异或运算符 ^

### 3.1 运算规则
异或运算符 ^ 也称 XOR 运算符。它的规则是若参加运算的两个二进位同号，则结果为 0 ，异号则为 1 。

    0 ^ 0 = 0
    0 ^ 1 = 1
    1 ^ 0 = 1
    1 ^ 1 = 0

### 3.2 简单应用

#### 3.2.1 特定位翻转
假设有 01111010，想使其低 4 位翻转，即 1 变为 0 ，0 变为 1 ，可以将它与 00001111进行 ^ 运算，结果值的低 4 位正好是原数低4位的翻转。即：

    01111010
    00001111 ^
    01110101 结果

#### 3.2.2 与 0 相 ^ 保留原值
如 012 ^ 00 = 012 ，因为原数中的 1 与 0 进行 ^ 运算得 1 ，0 与 1 运算得 0 ，故保留原数。

    00001010
    00000000 ^
    00001010 结果

#### 3.2.3 两数交换，不引入临时变量
假如 a = 3 , b = 4 ，想将 a 和 b 的值互换，可以用以下语句实现：

    a = a ^ b;
    b = b ^ a;
    a = a ^ b;
    各个变量的变化如下：
    //1. 初始状态
    a = 00000011
    b = 00000100
    //2. a = a ^ b，之后
    a = 00000111 = 7
    b = 00000100 = 4
    //3. b = b ^ a，之后
    a = 00000111 = 7
    b = 00000011 = 3
    //4. a = a ^ b，之后
    a = 00000100 = 4
    b = 00000011 = 3


## 4 取反运算符 ~

### 4.1 运算规则
~ 是单目运算符，用于对一个二进制数按位取反，即：将 0 变 1 ，1 变 0 。例如~ 025 是对八进制数 025 （即 00010101）按位取反，如下：

    ~ 00000000 00010101
      11111111 11101010

注意： ~运算符的优先级别比算术运算符、关系运算符、逻辑运算符和其它运算符都高，例如表达式：~a & b 在运算时，先进行 ~a 然后进行 & 运算。


## 5 左移运算符 <<

### 5.1 运算规则
用来将一个数各二进位全部左移若干位。例如：

    (a = 00001111) << 2 = 00111100;

### 5.2 注意
将 a 的二进制数左移 2 位，右补 0，若高位左移后溢出，则舍弃。

左移一位相当于该数乘以2，左移n位即该书乘以\\(2^n\\)。

需要注意，如果一个整数左移时溢出，且舍弃的高位中包含1 ，则以上结论不成立。


## 6 右移运算符 >>

### 6.1 运算规则
a >> 2 表示将 a 的各二进位右移 2 位。移到右端的低位被舍弃，对无符号数，高位补 0。如 a = 017（八进制）右移时：

    (a = 00001111) >> 2 = 00000011

### 6.2 注意
右移一位相当于除以 2 ，右移 n 位相当于除于 \\(2^n\\)。

在右移时，需要注意符号位问题。对无符号数，右移时左边高位用 0 补位；对于有符号的值，如果原来符号位为 0 （该数为正），则左边高位用 0 补位；如果符号位原来为 1 （该数为负），则左边高位用  0 补位，还是 1 补位，要取决于所用的计算机系统。高位用 0 补位称为 逻辑右移，即简单右移，高位用 1 补位称为算术右移。




## 参考文章

- Matrix67大牛的4篇关于位运算的文章: <http://www.matrix67.com/blog/archives/122>
- <http://blog.chinaunix.net/uid-21411227-id-1826986.html>
- <http://www.cnblogs.com/qkhhxkj/archive/2011/06/29/2093894.html>
- 百度百科: <http://baike.baidu.com/link?url=Biu9MTgLAVn1Oj4A-ZSSmh_GCcEQ-8eE75LggLQD4fVfHYxfHEADTx-vHI8R1udEhdx9IoIEXu1VmeeRjw2kEK>

特别说明：本文对以上参考文章有多处引用和借鉴，如有侵权，请留言，小生必改之，谢谢。
